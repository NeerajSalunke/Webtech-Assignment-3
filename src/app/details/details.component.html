<div class="container">
    <div *ngIf="isLoading; else detailsLoaded">
        <mat-spinner class="mx-auto"></mat-spinner>
    </div>
    <ng-template #detailsLoaded>
        <div class="row mt-4">
            <div class="nameCard col text-center">
                <p style="font-weight: bold; font-size: larger;">{{responseDataProfile.ticker}}
                    <span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-star" viewBox="0 0 16 16">
                            <path
                                d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z" />
                        </svg>
                    </span>
                </p>
                <p style="font-weight: bold;">{{responseDataProfile.name}}</p>
                <p>{{responseDataProfile.exchange}}</p>
            </div>
            <div class="logo col text-center">
                <img src="{{responseDataProfile.logo}}">
            </div>
            <div class="stockPrice col text-center">
                <div *ngIf="responseDataQuote.d < 0" style="color: red;">
                    <p>{{responseDataQuote.c}}</p>
                    <p>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-caret-down-fill" viewBox="0 0 16 16">
                            <path
                                d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z" />
                        </svg>
                        {{responseDataQuote.d}}({{responseDataQuote.dp}}%)
                    </p>
                    <p style="color: black;">{{formatDate(responseDataQuote.t)}}</p>
                </div>
                <div *ngIf="responseDataQuote.d >= 0" style="color: green;">
                    <p>{{responseDataQuote.c}}</p>
                    <p>

                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-caret-up-fill" viewBox="0 0 16 16">
                            <path
                                d="m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z" />
                        </svg>
                        {{responseDataQuote.d}}({{responseDataQuote.dp}}%)
                    </p>
                    <p style="color: black;">{{formatDate(responseDataQuote.t)}}</p>
                </div>
            </div>
        </div>
        <div class="row mt-4 text-center">
            <div *ngIf="timeDiff(responseDataQuote.t); else elseBlock">
                <p style="color: green;">Market is Open</p>
            </div>
            <ng-template #elseBlock>
                <p style="color: red;">Market is Closed</p>
            </ng-template>
        </div>
        <mat-tab-group>
            <mat-tab label="Summary">
                <div class="row">

                    <div class="col text-center">
                        <p><span style="font-weight: bold;">High Price: </span>{{responseDataQuote.h}}</p>
                        <p><span style="font-weight: bold;">Low Price: </span>{{responseDataQuote.l}}</p>
                        <p><span style="font-weight: bold;">Open Price: </span>{{responseDataQuote.o}}</p>
                        <p><span style="font-weight: bold;">Prev. Close: </span>{{responseDataQuote.pc}}</p>

                        <p style="font-weight: bold; text-decoration: underline;">About the company</p>
                        <p><span style="font-weight: bold;">IPO Start Date: </span>{{responseDataProfile.ipo}}</p>
                        <p><span style="font-weight: bold;">Industry: </span>{{responseDataProfile.finnhubIndustry}}</p>
                        <p><span style="font-weight: bold;">Webpage: </span><a href="{{responseDataProfile.weburl}}"
                                target="_blank">{{responseDataProfile.weburl}}</a></p>
                        <p><span style="font-weight: bold;">Company Peers: </span>
                            <ng-container *ngFor="let peer of responseDataPeers">
                                <ng-container *ngIf="!peer.includes('.')">
                                    <a href="javascript:void(0);" (click)="searchPeer(peer)">{{peer}}</a>
                                    <span>, </span>
                                </ng-container>
                            </ng-container>
                        </p>
                    </div>
                    <div class="col">
                        Chart
                    </div>
                </div>
            </mat-tab>
            <mat-tab label="Top News"> Content 2 </mat-tab>
            <mat-tab label="Charts"> Content 3 </mat-tab>
            <mat-tab label="Insights">
                <p class="text-center" style="font-size: x-large;">Insider Sentiments</p>
                <div class="container">

                    <table class="table1 text-center">
                        <tr>
                            <td>{{responseDataProfile.name}}</td>
                            <td>MSPR</td>
                            <td>Change</td>
                        </tr>
                        <tr>
                            <td>Total</td>
                            <td>{{aggregateMSPR("t")}}</td>
                            <td>{{aggregateChange("t")}}</td>
                        </tr>
                        <tr>
                            <td>Positive</td>
                            <td>{{aggregateMSPR("p")}}</td>
                            <td>{{aggregateChange("p")}}</td>
                        </tr>
                        <tr>
                            <td>Negative</td>
                            <td>{{aggregateMSPR("n")}}</td>
                            <td>{{aggregateChange("n")}}</td>
                        </tr>
                    </table>
                </div>
            </mat-tab>
        </mat-tab-group>
    </ng-template>
</div>